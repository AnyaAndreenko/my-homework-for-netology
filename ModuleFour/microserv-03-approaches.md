# Домашнее задание к занятию «Микросервисы: подходы»


### Задача 1: Обеспечить разработку

__Предложите решение для обеспечения процесса разработки:__ хранение исходного кода, непрерывная интеграция и непрерывная поставка. Решение может состоять из одного или нескольких программных продуктов и должно описывать способы и принципы их взаимодействия.


__Используем стек:__

__GitHub__ — как облачную систему хранения кода и систему контроля версий.


__GitHub Actions__ — для CI/CD.

__Docker Registry (GitHub Packages / Harbor)__ — хранение докер-образов.

__Vault или GitHub Secrets__ — для безопасного хранения секретов.


__Обоснование и взаимодействие__

__GitHub:__
1. Хранение кода в репозиториях, один репозиторий — один микросервис.
2. События push/pull request инициируют сборку.
3. Возможность запускать workflow по кнопке (workflow_dispatch) с параметрами.
   
__GitHub Actions:__
1. Позволяет задавать шаблоны сборок (reusable workflows).
2. Поддерживает хранение параметров для каждой сборки.
3. Кастомные шаги и собственные Docker-образы — через docker build и runs-on: self-hosted.
4. Поддержка параллельных сборок (matrix strategy) и тестов.
5. Возможность подключения self-hosted runners (агентов) на свои сервера.

   
__GitHub Secrets:__
Безопасное хранение токенов, ключей, паролей.
   
__Docker Registry:__
Хранение собранных артефактов (образов). Быстрый доступ к образам
   
__Альтернативы:__

1. GitLab + GitLab CI/CD — аналогичная функциональность, «всё в одном».
2. TeamCity / Jenkins + GitHub — при необходимости максимальной кастомизации и гибкости.

### Задача 2: Логи

Предложите решение для обеспечения сбора и анализа логов сервисов в микросервисной архитектуре. Решение может состоять из одного или нескольких программных продуктов и должно описывать способы и принципы их взаимодействия.


__Используем стек:__
__Loki + Promtail + Grafana__

__Обоснование и взаимодействие:__
__Promtail:__
1. Устанавливается на все хосты.
2. Читает stdout и логи из файлов, передаёт в Loki.
3. Минимальные требования к приложениям — логирование в stdout.

   
__Loki:__
1. Центральное хранилище логов (Time-series DB от Grafana Labs).
2. Гарантированная доставка логов с буферизацией и retry.

   
__Grafana:__
1. Интерфейс поиска и фильтрации логов.
2. Поддержка сохранённых поисков (можно делиться ссылками).
3. Управление доступом (RBAC).

   
__Преимущества:__
1. Легко разворачивается.
2. Низкое потребление ресурсов.
3. Удобная интеграция с Prometheus и общая панель в Grafana.

   
__Альтернативы:__
1. ELK (Elasticsearch + Logstash + Kibana) — более тяжёлый, но мощный стек.
2. Fluent Bit + OpenSearch + OpenSearch Dashboards — open-source альтернатива ELK.

### Задача 3: Мониторинг

Предложите решение для обеспечения сбора и анализа состояния хостов и сервисов в микросервисной архитектуре. Решение может состоять из одного или нескольких программных продуктов и должно описывать способы и принципы их взаимодействия.


__Используем стек:__

__Prometheus + Node Exporter + Grafana__

(Опционально: cAdvisor, blackbox-exporter, custom-exporters для метрик сервисов)

__Обоснование и взаимодействие__

__Node Exporter:__

__Сбор метрик хостов:__ CPU, RAM, диск, сеть.
__Prometheus:__

1. Централизованный сбор всех метрик.
2. Хранение и агрегация.
3. Поддержка кастомных метрик через /metrics endpoint в микросервисах.
   
__Grafana:__

1. Настройка дашбордов.
2. Запросы, агрегации, алерты.
3. Много готовых панелей для Node Exporter, cAdvisor и др.

   
__cAdvisor:__
Сбор метрик потребления ресурсов по контейнерам (CPU, RAM и т.д.)

__Blackbox Exporter:__
Проверка доступности сервисов по HTTP, TCP и др.

__Преимущества:__
1. Широкая поддержка.
2. Отличный UI в Grafana.
3. Расширяемость и гибкость.

   
__Альтернативы:__
__Zabbix или Datadog__ — более "коробочные" решения, но могут требовать лицензий.

