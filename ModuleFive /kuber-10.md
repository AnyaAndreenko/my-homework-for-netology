# Домашнее задание к занятию «Компоненты Kubernetes»

## Задание. Необходимо определить требуемые ресурсы
Известно, что проекту нужны база данных, система кеширования, а само приложение состоит из бекенда и фронтенда. 
Опишите, какие ресурсы нужны, если известно:


1. Необходимо упаковать приложение в чарт для деплоя в разные окружения.

2. База данных должна быть отказоустойчивой. Потребляет 4 ГБ ОЗУ в работе, 1 ядро. 3 копии.
   
3. Кеш должен быть отказоустойчивый. Потребляет 4 ГБ ОЗУ в работе, 1 ядро. 3 копии.
   
4. Фронтенд обрабатывает внешние запросы быстро, отдавая статику. Потребляет не более 50 МБ ОЗУ на каждый экземпляр, 0.2 ядра. 5 копий.

5. Бекенд потребляет 600 МБ ОЗУ и по 1 ядру на копию. 10 копий.

 __Расчет требуемых ресурсов для проекта__
 
__Расчет ресурсов для каждого компонента__

База данных (PostgreSQL, MySQL, etc.): (с учетом На 1 копию: 4 ГБ ОЗУ, 1 ядро CPU. Количество копий: 3.)

__Итого:__

ОЗУ: 4 ГБ * 3 = 12 ГБ.

CPU: 1 * 3 = 3 ядра.

__Система кеширования (Redis, Memcached): (с учетом На 1 копию: 4 ГБ ОЗУ, 1 ядро CPU. Количество копий: 3.)__

__Итого:__

ОЗУ: 4 ГБ * 3 = 12 ГБ.

CPU: 1 * 3 = 3 ядра.

Фронтенд (Nginx, React, etc.): (с учетом На 1 копию: 50 МБ ОЗУ, 0.2 ядра. Количество копий: 5.)

__Итого:__

ОЗУ: 50 МБ * 5 = 250 МБ (0.25 ГБ).

CPU: 0.2 * 5 = 1 ядро.

Бекенд (Django, Spring, etc.): (с учетом На 1 копию: 600 МБ ОЗУ, 1 ядро. Количество копий: 10.)

__Итого:__

ОЗУ: 600 МБ * 10 = 6000 МБ (6 ГБ).

CPU: 1 * 10 = 10 ядер.

__2. Суммарные ресурсы для всех компонентов:__

ОЗУ: 12 (БД) + 12 (кеш) + 0.25 (фронт) + 6 (бек) = 30.25 ГБ.

CPU: 3 (БД) + 3 (кеш) + 1 (фронт) + 10 (бек) = 17 ядер.

__3. Учет запаса на отказоустойчивость (выход одной ноды):__

Обычно запас составляет 20-30% от общего количества ресурсов.

ОЗУ с запасом: 30.25 ГБ * 1.3 ≈ 40 ГБ.

CPU с запасом: 17 * 1.3 ≈ 22 ядра.

__4. Учет служебных ресурсов нод:__
Для Kubernetes или другого оркестратора требуется дополнительно:

На мастер-ноду (если управляемая):__ 2 ГБ ОЗУ, 1 ядро (может быть внешней).__

На рабочую ноду: __0.5 ГБ ОЗУ, 0.5 ядра на ноду (для системных процессов, kubelet, etc.).__

__5. Расчет количества нод:__

Предположим, используем ноды с характеристиками:

16 ГБ ОЗУ, 8 ядер CPU (стандартная облачная нода).

Ресурсы на ноду без учета служебных:

Доступно: 16 ГБ ОЗУ, 8 ядер.

С учетом служебных: 15.5 ГБ ОЗУ, 7.5 ядер.

__Расчет:__

ОЗУ: 40 ГБ / 15.5 ≈ 2.58 → 3 ноды.

CPU: 22 / 7.5 ≈ 2.93 → 3 ноды.

Итог: 3 ноды удовлетворяют требованиям.

__6. Проверка распределения:__

На 3 ноды:

ОЗУ на ноду: 40 / 3 ≈ 13.3 ГБ (в пределах 15.5 ГБ).

CPU на ноду: 22 / 3 ≈ 7.3 ядра (в пределах 7.5).

__Итоговая конфигурация:__

Количество нод: __3.__

__Параметры каждой ноды:__

__ОЗУ:__ 16 ГБ (15.5 ГБ доступно).

__CPU:__ 8 ядер (7.5 доступно).

__Диск:__ SSD/NVMe (отдельно рассчитывается под БД и кеш, минимум 100 ГБ на ноду).

__Запас:__ 1 нода (отказоустойчивость).

Служебные ресурсы: Учтены в расчетах (0.5 ГБ ОЗУ, 0.5 ядра на ноду).

__Дополнительные рекомендации:__
Для БД и кеша лучше использовать ноды с локальным SSD (если критична задержка).

Можно разнести БД и кеш на отдельные ноды для изоляции.

Для продакшена добавить мониторинг (Prometheus, Grafana) + логи (Loki, ELK), что потребует дополнительных ресурсов  
